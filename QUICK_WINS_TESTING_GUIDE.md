# Quick Wins 測試指南

**測試日期**: 2025-12-19
**測試範疇**: 批次選擇、Zod 驗證、快捷鍵系統、Skeleton Loading

---

## 🚀 啟動測試環境

### 1. 啟動開發伺服器

```bash
cd foodsense-frontend
npm run dev
```

瀏覽器訪問: http://localhost:3000

### 2. 確保後端 API 運行

```bash
# 在另一個終端機
cd ../foodsense-bacend/backend
uvicorn app.main:app --reload --port 8000
```

---

## ✅ 測試清單

### 一、批次選擇功能測試

**測試頁面**: `/review/queue`

#### Test 1: 單選功能
- [ ] 點擊任一記錄的 checkbox
- [ ] 確認該列背景色變為高亮
- [ ] 確認頂部出現 "已選擇 1 筆記錄" 工具列
- [ ] 確認工具列有 "取消選擇" 和 "批次審核" 按鈕

#### Test 2: 多選功能
- [ ] 點擊多個記錄的 checkbox (如: 選擇 3 筆)
- [ ] 確認所有選中的列都有高亮背景
- [ ] 確認工具列顯示 "已選擇 3 筆記錄"

#### Test 3: 全選功能
- [ ] 點擊表頭的 checkbox (全選按鈕)
- [ ] 確認所有記錄都被選中
- [ ] 確認工具列顯示 "已選擇 N 筆記錄" (N = 總記錄數)
- [ ] 再次點擊表頭 checkbox
- [ ] 確認所有選擇被清除

#### Test 4: 取消選擇
- [ ] 選擇數筆記錄
- [ ] 點擊工具列的 "取消選擇" 按鈕
- [ ] 確認所有選擇被清除,工具列消失

#### Test 5: 批次審核按鈕
- [ ] 選擇數筆記錄
- [ ] 點擊 "批次審核" 按鈕
- [ ] 確認觸發回調 (目前可能只有 console.log,需要實作批次 Modal)

**預期行為**:
- ✅ Checkbox 狀態正確切換
- ✅ 視覺化高亮清晰可見
- ✅ 工具列即時更新計數
- ✅ 全選/反選正常運作

---

### 二、Zod 表單驗證測試

**測試頁面**: `/review/queue` → 點擊任一記錄的 "審核" 按鈕

#### Test 1: 基本範圍驗證
- [ ] 品質分數輸入 0 → 應顯示紅色錯誤訊息: "品質分數最低為 1"
- [ ] 品質分數輸入 11 → 應顯示錯誤: "品質分數最高為 10"
- [ ] 品質分數輸入 5.5 → 應顯示錯誤: "品質分數必須是整數"
- [ ] 信心分數輸入 -0.1 → 應顯示錯誤: "信心分數最低為 0"
- [ ] 信心分數輸入 1.5 → 應顯示錯誤: "信心分數最高為 1"

#### Test 2: 黃金樣本驗證
- [ ] 勾選 "Mark as Gold Sample"
- [ ] 品質分數設為 7,信心度 0.9,備註為空 → 應顯示錯誤
- [ ] 品質分數設為 9,信心度 0.80,備註為空 → 應顯示錯誤
- [ ] 品質分數設為 9,信心度 0.90,備註輸入 "測試" (少於10字) → 應顯示錯誤
- [ ] 品質分數設為 9,信心度 0.90,備註輸入 "這是一個完整的黃金樣本備註說明" → 應通過驗證

**預期錯誤訊息**: "黃金樣本需要:品質分數≥8、信心度≥0.85、且備註至少10個字"

#### Test 3: 邏輯一致性驗證 - 高品質低信心
- [ ] 品質分數設為 9
- [ ] 信心分數設為 0.5
- [ ] 應顯示錯誤: "高品質評分(≥8)應該搭配較高的信心度(≥0.7)"

#### Test 4: 邏輯一致性驗證 - 低品質高信心
- [ ] 品質分數設為 3
- [ ] 信心分數設為 0.9
- [ ] 應顯示錯誤: "低品質評分(≤4)不應搭配過高的信心度(>0.7)"

#### Test 5: 正常提交
- [ ] 品質分數設為 8
- [ ] 信心分數設為 0.85
- [ ] 備註輸入適當內容
- [ ] 點擊 "Approve & Create Ground Truth"
- [ ] 應成功提交,Modal 關閉,顯示成功 toast

**預期行為**:
- ✅ 即時顯示驗證錯誤
- ✅ 阻擋無效提交
- ✅ 錯誤訊息清晰易懂
- ✅ 有效資料順利提交

---

### 三、快捷鍵系統測試

**測試頁面**: 任何 dashboard 頁面

#### Test 1: Command Palette 開啟
- [ ] 按下 `Cmd+K` (Mac) 或 `Ctrl+K` (Windows/Linux)
- [ ] 確認彈出 Command Palette 對話框
- [ ] 確認有搜尋輸入框,上面有搜尋圖示
- [ ] 確認顯示命令列表

#### Test 2: 搜尋功能
- [ ] 在搜尋框輸入 "儀表板"
- [ ] 確認過濾出 "前往儀表板" 命令
- [ ] 輸入 "queue"
- [ ] 確認過濾出相關命令

#### Test 3: 鍵盤導航
- [ ] 按 `↓` 方向鍵
- [ ] 確認選擇移到下一個命令 (背景高亮)
- [ ] 按 `↑` 方向鍵
- [ ] 確認選擇移到上一個命令
- [ ] 按 `Enter`
- [ ] 確認執行選中的命令並關閉 Palette

#### Test 4: 導航快捷鍵
- [ ] 按 `g` 然後按 `d` → 應跳轉到儀表板
- [ ] 按 `g` 然後按 `q` → 應跳轉到審核佇列
- [ ] 按 `g` 然後按 `h` → 應跳轉到審核歷史
- [ ] 按 `g` 然後按 `g` → 應跳轉到黃金樣本
- [ ] 按 `g` 然後按 `p` → 應跳轉到產品總覽
- [ ] 按 `g` 然後按 `x` → 應跳轉到資料品質

#### Test 5: 關閉 Palette
- [ ] 按 `Cmd+K` 開啟 Palette
- [ ] 按 `Esc` 鍵
- [ ] 確認 Palette 關閉
- [ ] 點擊 Palette 外部區域
- [ ] 確認 Palette 關閉

#### Test 6: Help 快捷鍵
- [ ] 按 `Shift+/` (即 `?`)
- [ ] 確認開啟 Command Palette
- [ ] 確認底部有快捷鍵提示

**預期行為**:
- ✅ 快捷鍵即時響應
- ✅ 導航正確跳轉
- ✅ Command Palette UI 美觀
- ✅ 鍵盤導航流暢

---

### 四、Skeleton Loading 測試

**測試頁面**: `/products`, `/dashboard`, 其他資料載入頁面

#### Test 1: 產品頁面 Loading
- [ ] 清除瀏覽器快取
- [ ] 訪問 `/products` 頁面
- [ ] 確認顯示 ProductsLoadingSkeleton
- [ ] 骨架包含: 標題、篩選欄位、表格
- [ ] 確認有脈衝動畫 (灰色區塊閃爍)
- [ ] 資料載入完成後,骨架消失,顯示實際內容

#### Test 2: Layout Loading
- [ ] 登出後重新登入
- [ ] 確認 Layout loading 顯示旋轉 spinner
- [ ] Spinner 置中顯示
- [ ] 有 "載入中..." 文字

#### Test 3: 視覺連貫性
- [ ] 觀察 Skeleton 佈局與實際內容的一致性
- [ ] 確認沒有明顯的佈局跳動 (Layout Shift)
- [ ] 確認動畫流暢

#### Test 4: 其他頁面 (可選)
- [ ] Dashboard: 應有卡片 + 表格骨架
- [ ] Review Queue: 應有表格骨架
- [ ] Dictionary: 應有篩選 + 表格骨架

**預期行為**:
- ✅ Loading 狀態視覺專業
- ✅ 沒有空白畫面閃爍
- ✅ 佈局與實際內容一致
- ✅ 動畫流暢不卡頓

---

## 🐛 已知問題記錄

### 問題 1: [範例]
**症狀**: 批次選擇後點擊批次審核無反應
**原因**: 父組件未實作 `onBatchReview` 回調
**解決方案**: 在 `review/queue/page.tsx` 實作批次審核處理邏輯

### 問題 2: [待填寫]
**症狀**:
**原因**:
**解決方案**:

---

## 📊 測試結果摘要

| 測試項目 | 通過 | 失敗 | 跳過 | 備註 |
|---------|------|------|------|------|
| 批次選擇功能 | ☐ | ☐ | ☐ | |
| Zod 表單驗證 | ☐ | ☐ | ☐ | |
| 快捷鍵系統 | ☐ | ☐ | ☐ | |
| Skeleton Loading | ☐ | ☐ | ☐ | |

**總結**: ☐ 全部通過 / ☐ 部分通過 / ☐ 需要修復

---

## 🔧 除錯技巧

### 檢查 Console 錯誤
```bash
# 瀏覽器 DevTools Console 中查看:
# - React Hook Form 驗證錯誤
# - Hotkeys 綁定狀態
# - API 請求錯誤
```

### 檢查 React DevTools
- 查看 ReviewQueueTable 的 `selectedIds` state
- 查看 ReviewModal 的 `formState.errors`
- 查看 CommandPalette 的 `open` prop

### 檢查 Network 請求
- 審核提交時檢查 POST /admin/review/submit
- 確認 payload 包含正確的驗證數據

---

## 📝 回饋與改進

測試完成後,請記錄:

1. **使用者體驗**:
   - 哪些功能最實用?
   - 哪些需要調整?
   - 是否有混淆的地方?

2. **效能表現**:
   - Loading 速度是否滿意?
   - 快捷鍵響應是否即時?
   - 批次操作是否流暢?

3. **改進建議**:
   - 需要哪些額外功能?
   - UI/UX 改進點?
   - 快捷鍵調整建議?

---

**測試執行人**: ________________
**測試日期**: ________________
**測試環境**: ________________
**測試結果**: ☐ 通過 / ☐ 需要修復

